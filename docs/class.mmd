classDiagram
  namespace Entities {
    class RuleContext
    class FunctionInfo
    class Violation
    class FixResult
  }
  namespace useCases {
    class RunPipeline
    class ParseAndBuildContext
    class ExecuteRules
  }
  namespace interfaceAdapters {
    class ViolationRule
    class RuleRegistry
    class FileService
    class ConfigLoader
  }
  namespace external {
    class TypeScriptAPI
    class BunFS
    class CLI
  }

  RunPipeline --> ParseAndBuildContext
  RunPipeline --> ExecuteRules
  RunPipeline --> RuleRegistry
  RunPipeline --> FileService
  RunPipeline --> ConfigLoader
  ParseAndBuildContext --> RuleContext
  ParseAndBuildContext --> TypeScriptAPI
  ParseAndBuildContext --> FileService
  ExecuteRules --> ViolationRule
  ExecuteRules --> RuleContext
  ExecuteRules --> Violation
  ExecuteRules --> FixResult
  ExecuteRules --> FileService
  ViolationRule <|.. StepdownRule
  ViolationRule <|.. NestedRule
  RuleRegistry --> ViolationRule
  CLI --> RunPipeline
  FileService --> BunFS
  ParseAndBuildContext --> BunFS

  ViolationRule : +id string
  ViolationRule : +analyze(ctx) Violation[]
  ViolationRule : +fix(ctx, violations) string
  RuleContext : +parsedFile
  RuleContext : +functions
  RuleContext : +callGraph
  RuleContext : +dependencyGraph